function [y] = QAM16_demapper(X)

X = X*sqrt(10);
L = length(X);
y = zeros(1,4*L);

point = [
    0,0,0,0;
    0,0,0,1;
    0,0,1,0;
    0,0,1,1 ;
    0,1,0,0 ;
    0,1,0,1 ;
    0,1,1,0 ;
    0,1,1,1 ;
    1,0,0,0 ;
    1,0,0,1 ;
    1,0,1,0 ;
    1,0,1,1 ;
    1,1,0,0 ;
    1,1,0,1 ;
    1,1,1,0 ;
    1,1,1,1];
const = [
    -3-3j;
    -3-1j;
    -3+3j;
    -3+1j;
    -1-3j;
    -1-1j;
    -1+3j;
    -1+1j;
    3-3j;
    3-1j;
    3+3j;
    3+1j;
    1-3j;
    1-1j;
    1+3j;
    1+1j];

for n=1:L
    a = abs(const - X(n));
    [C,D] = min(a);
    y(4*(n-1)+1:4*n) = point(D,:);
end

